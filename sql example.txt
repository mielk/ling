        public List<ReservesObject> GetReserveObjectByHimmsForLatam(long merchantId, int procCenterId)
        {

            var departments = GetDBContext().Departments;

            List<ReservesObject> reservesObjectList = (from resSumObj in this.GetDBContext().ReserveSummaries.AsEnumerable()
                                                       where resSumObj.ID_PROCCENTER == procCenterId
                                                       join midDetails in this.GetDBContext().MidDetails
                                                              on resSumObj.ID_RESERVE equals midDetails.ID_RESERVE
                                                       where resSumObj.Himms2MID == merchantId

                                                       let revDetails = (from rv in resSumObj.ReviewDetails
                                                                         where rv.ID_RESERVE == resSumObj.ID_RESERVE
                                                                         select new
                                                                         {
                                                                             rv.Currency.CURRENCY_NAME,
                                                                             rv.ID_CURRENCY,
                                                                             rv.ID_DEPARTMENT,
                                                                             rv.REVIEW_AMOUNT,
                                                                             rv.REVIEW_DATE,
                                                                             DEPARTMENT_NAME = departments.FirstOrDefault(x => x.ID_DEPARTMENT == rv.ID_DEPARTMENT).DEPARTMENT_NAME,
                                                                             DEPARTMENT_ID_COMMON = departments.FirstOrDefault(x => x.ID_DEPARTMENT == rv.ID_DEPARTMENT).DEPARTMENT_ID_COMMON
                                                                         }).FirstOrDefault()

                                                       select new ReservesObject()
                                                       {
                                                           ID = resSumObj.ID_RESERVE,
                                                           CLG = Convert.ToInt32(midDetails.CLG, CultureInfo.InvariantCulture),
                                                           Currency = revDetails != null ? (revDetails.ID_CURRENCY.HasValue ? new EUOSD.Reserves.Common.DomainObjects.Currency()
                                                           {
                                                               CurrencyID = revDetails.ID_CURRENCY.Value,
                                                               CurrencyName = revDetails.CURRENCY_NAME
                                                           }
                                                           : null) : null,
                                                           CurrencyId = revDetails != null ? (revDetails.ID_CURRENCY.HasValue ? revDetails.ID_CURRENCY.Value : (int?)null) : null,
                                                           Department = revDetails != null ? (revDetails.ID_DEPARTMENT.HasValue ? new EUOSD.Reserves.Common.DomainObjects.Department()
                                                           {
                                                               DepartmentID = revDetails.ID_DEPARTMENT.Value,
                                                               DepartmentName = revDetails.DEPARTMENT_NAME,
                                                               CommonId = revDetails.DEPARTMENT_ID_COMMON
                                                           }
                                                           : null) : null,
                                                           DepartmentId = revDetails != null ? (revDetails.ID_DEPARTMENT.HasValue ? revDetails.ID_DEPARTMENT.Value : (int?)null) : null,
                                                           HIMMS2MID = resSumObj.Himms2MID, // there is only MPS MID in the database
                                                           MPS2MID = resSumObj.MID,
                                                           Name = midDetails.DBA_NAME,
                                                           Comment = midDetails.Comment,
                                                           ReviewAmount = revDetails != null ? revDetails.REVIEW_AMOUNT : null,
                                                           OriginalCurrency = midDetails.OriginalCurrency,
                                                           ReviewDate = revDetails != null ? revDetails.REVIEW_DATE : null,
                                                           AmountSummary = (from resDetails in this.GetDBContext().ReserveDetails where resDetails.MID == merchantId select resDetails.AMOUNT).DefaultIfEmpty(0).Sum()
                                                       }).DefaultIfEmpty(new ReservesObject()).ToList();

            return reservesObjectList;
        }