Public Function openBrowser(Address As String) As Object 'opens browser :)
    Const LOGIN_URL As String = "https://himms2.euroconex.prv/HIMMS2/login.do"
    Const LOOP_TIMEOUT As Long = 100
    '---------------------------------------------------
    Dim oIE As SHDocVw.InternetExplorer
    Dim okno As SHDocVw.ShellWindows
    Dim strAddress As String
    Dim objIEWindow As Object
    Dim intCounter As Integer

        
    'Opening new IE instance
    Set objIEWindow = CreateObject("InternetExplorer.application")
    With objIEWindow
        .Visible = True
        Call .navigate(Address)
    End With
    Set objIEWindow = Nothing



    Do
    
        intCounter = intCounter + 1
        If intCounter > LOOP_TIMEOUT Then Exit Do
    
        'Assigning this IE window to the oIE variable
        Set okno = New SHDocVw.ShellWindows
        For Each oIE In okno
            'Debug.Print oIE.LocationURL
            strAddress = oIE.LocationURL
            If StrComp(strAddress, Address, vbTextCompare) = 0 Or StrComp(strAddress, LOGIN_URL, vbTextCompare) = 0 Then
                Set openBrowser = oIE
                Exit Do
            End If
        Next oIE
        
    Loop While objIEWindow Is Nothing



End Function